{"version":3,"sources":["app/components/dynamic-module-loader/terra-dynamic-module-loader.component.ts"],"names":[],"mappings":"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","file":"app/components/dynamic-module-loader/terra-dynamic-module-loader.component.js","sourcesContent":["import {\n    AfterViewInit,\n    Component,\n    ComponentRef,\n    Input,\n    ModuleWithComponentFactories,\n    ModuleWithProviders,\n    OnChanges,\n    OnDestroy,\n    SimpleChanges,\n    ViewChild,\n    ViewContainerRef\n} from '@angular/core';\nimport { JitCompiler } from '@angular/compiler';\nimport { TerraMultiSplitViewInterface } from '../split-view/multi/data/terra-multi-split-view.interface';\nimport { isNullOrUndefined } from 'util';\nimport { TerraDynamicLoadedComponentInputInterface } from './data/terra-dynamic-loaded-component-input.interface';\n\n@Component({\n    selector: 'terra-dynamic-module-loader',\n    template: require('./terra-dynamic-module-loader.component.html'),\n    styles:   [require('./terra-dynamic-module-loader.component.scss')]\n})\nexport class TerraDynamicModuleLoaderComponent implements AfterViewInit, OnChanges, OnDestroy\n{\n    @ViewChild('viewChildTarget', {read: ViewContainerRef}) viewChildTarget;\n    @Input() inputModule:any;\n    @Input() inputMainComponentName:string;\n    @Input() inputParameter:any; // TODO: remove input if old split-view is removed\n    @Input() inputInputs:Array<TerraDynamicLoadedComponentInputInterface>;\n    @Input() inputView:TerraMultiSplitViewInterface;\n    private _resolvedData:ModuleWithProviders;\n\n    private _cmpRef:ComponentRef<any>;\n\n    constructor(private _jitCompiler:JitCompiler)\n    {\n    }\n\n    public ngAfterViewInit()\n    {\n        this._resolvedData = this.inputModule as ModuleWithProviders;\n        this.updateComponent();\n    }\n\n    public ngOnChanges(changes:SimpleChanges):void\n    {\n        if(changes.hasOwnProperty('inputInputs'))\n        {\n            this.assignInputProperties();\n        }\n    }\n\n    public ngOnDestroy()\n    {\n        if(this._cmpRef)\n        {\n            this._cmpRef.destroy();\n        }\n    }\n\n    private updateComponent():void\n    {\n        this._jitCompiler.compileModuleAndAllComponentsAsync(this._resolvedData.ngModule)\n            .then((moduleWithFactories:ModuleWithComponentFactories<any>) =>\n            {\n                moduleWithFactories.componentFactories.forEach((factory) =>\n                    {\n                        if(this.inputMainComponentName === factory.componentType.name)\n                        {\n                            // create the component\n                            this._cmpRef = this.viewChildTarget.createComponent(factory);\n\n                            // pass the instance of the loaded view back to the component\n                            this._cmpRef.instance.splitViewInstance = this.inputView;\n\n                            // pass the delivered parameter to the component\n                            this._cmpRef.instance.parameter = this.inputParameter; // TODO: deprecated if old split view is removed\n\n                            // add inputs to component for data binding purposes\n                            this.assignInputProperties();\n                        }\n                    }\n                );\n\n            });\n    }\n\n    private assignInputProperties()\n    {\n        if(!isNullOrUndefined(this.inputInputs) && this._cmpRef)\n        {\n            this.inputInputs.forEach((input:TerraDynamicLoadedComponentInputInterface) =>\n                {\n                    if(!isNullOrUndefined(input) && !isNullOrUndefined(input.name))\n                    {\n                        this._cmpRef.instance[input.name] = input.value;\n                    }\n                }\n            );\n            this._cmpRef.changeDetectorRef.detectChanges();\n        }\n    }\n}\n"],"sourceRoot":"/source/"}