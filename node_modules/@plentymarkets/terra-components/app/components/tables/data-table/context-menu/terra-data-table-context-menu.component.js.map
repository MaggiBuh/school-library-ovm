{"version":3,"sources":["app/components/tables/data-table/context-menu/terra-data-table-context-menu.component.ts"],"names":[],"mappings":"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","file":"app/components/tables/data-table/context-menu/terra-data-table-context-menu.component.js","sourcesContent":["import { Component } from '@angular/core';\nimport { TerraDataTableContextMenuService } from './service/terra-data-table-context-menu.service';\nimport { TerraDataTableContextMenuEntryInterface } from './data/terra-data-table-context-menu-entry.interface';\nimport { TerraBaseData } from '../../../data/terra-base.data';\n\n/**\n * @author mkunze\n */\n@Component({\n    // tslint:disable-next-line\n    selector: 'context-menu', // it still exists a terra-context-menu in terra, need to refactored first\n    styles:   [require('./terra-data-table-context-menu.component.scss')],\n    template: require('./terra-data-table-context-menu.component.html')\n})\nexport class TerraDataTableContextMenuComponent<D extends TerraBaseData>\n{\n    private _contextMenuLinkList:Array<TerraDataTableContextMenuEntryInterface<D>> = [];\n    private _isShown:boolean = false;\n    private clickListener:(event:Event) => void;\n    private _locationCss:any = {\n        visibility: 'hidden',\n        left:       0,\n        top:        0,\n        right:      0\n    };\n\n    private _mouseLocation:{ left:number, top:number } = {\n        left: 0,\n        top:  0\n    };\n\n    constructor(private _contextMenuService:TerraDataTableContextMenuService<D>)\n    {\n        _contextMenuService.show.subscribe(\n            (e:any):void => this.showMenu(e.event, e.obj));\n\n        _contextMenuService.init.subscribe(\n            (e:any):void => this._contextMenuLinkList = e\n        );\n\n        this.clickListener = (event:Event):void =>\n        {\n            this.clickedOutside();\n            event.stopPropagation();\n        };\n    }\n\n    public clickedOutside():void\n    {\n        this._isShown = false;\n        this._locationCss = this.calcMenuPosition();\n        document.removeEventListener('click', this.clickListener);\n    }\n\n    public showMenu(event:MouseEvent, contextMenuLinkList:TerraDataTableContextMenuEntryInterface<D>[]):void\n    {\n        this._isShown = true;\n        this._contextMenuLinkList = contextMenuLinkList;\n        this._mouseLocation = {\n            left: event.clientX,\n            top:  event.clientY\n        };\n\n        this._locationCss = this.calcMenuPosition();\n\n        event.stopPropagation();\n        document.addEventListener('click', this.clickListener);\n    }\n\n    private calcMenuPosition():{ visibility:string, left:string, top:string }\n    {\n        // 70 (navbar) + 46 (tabbar) + 36 (breadcrumbs)\n        let offsetTop:number = 161;\n        let offsetLeft:number;\n        let anchor:JQuery = $('.context-menu#menu');\n        let isMenuAtBottom:boolean;\n        let contextMenuHeight:number = anchor.height();\n        let contextMenuWidth:number = anchor.width();\n        let tableWidth:number;\n\n        let buttomTop:string = this._mouseLocation.top - offsetTop - contextMenuHeight + 'px';\n        let top:string = this._mouseLocation.top - offsetTop - 2 + 'px';\n\n        if(this._mouseLocation.top + contextMenuHeight > innerHeight)\n        {\n            isMenuAtBottom = true;\n        }\n\n        let dataTableElement:JQuery = anchor.closest('terra-data-table');\n\n        offsetLeft = dataTableElement.offset().left;\n\n        tableWidth = dataTableElement.find('tbody').width();\n\n        if(Math.abs(this._mouseLocation.left - offsetLeft - 2) + contextMenuWidth > tableWidth)\n        {\n            offsetLeft = offsetLeft + contextMenuWidth - 6;\n        }\n\n        return {\n            visibility: this._isShown ? 'visible' : 'hidden',\n            left:       this._mouseLocation.left - offsetLeft - 2 + 'px',\n            top:        isMenuAtBottom ? buttomTop : top\n        };\n    }\n}\n"],"sourceRoot":"/source/"}